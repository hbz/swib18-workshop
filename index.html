<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>From LOD to LOUD: making data usable</title>

		<meta name="description" content="Workshop at SWIB18">
		<meta name="author" content="Adrian Pohl">
		<meta name="author" content="Pascal Christoph">
		<meta name="author" content="Fabian Steeg">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

		<script type="application/ld+json">
		{
			"@context": "http://schema.org",
			"id" : "https://hbz.github.io/swib18-workshop/",
			"type": "PresentationDigitalDocument",
			"name" : "From LOD to LOUD: making data usable",
			"creator" : [{
				"id": "http://lobid.org/team/ap#!",
				"type": "Person",
				"name": "Adrian Pohl"
			},
			{
				"id": "http://lobid.org/team/pc#!",
				"type": "Person",
				"name": "Pascal Christoph"
			},
			{
				"id": "http://lobid.org/team/fs#!",
				"type": "Person",
				"name": "Fabian Steeg"
			}],
			"description": "These are the accompanying slides for the SWIB18 workshop \"From LOD to LOUD: making data usable\".",
			"about" : [ "lobid", "libraries", "linked open data", "APIs", "JSON-LD" ],
			"datePublished" : "2018-11-26",
			"inLanguage" : "en",
			"audience": [ "librarians", "developers" ],
			"license": "https://creativecommons.org/licenses/by/4.0/"
		}
		</script>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/hbz.css" id="theme">

		<!-- Code syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
		<style>
			pre { white-space: pre-wrap; }
			#footer-left {
				position: absolute;
				bottom: 1%;
				left: 0.5%;
				color: lightgray;
				font-family: sans-serif;
			}
		</style>
	</head>
	<div id="footer-left"></div>
	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section data-state="adrian">
					<h2>From LOD to LOUD: <br/>making data usable</h2>
					<h4>Workshop at SWIB18</h4>
					<p>
						<small>
							<a href="http://fsteeg.com/">Fabian Steeg</a> /
							<a href="https://twitter.com/fsteeg">@fsteeg</a> &amp;
							<a href="http://www.uebertext.org/">Adrian Pohl</a> /
							<a href="https://twitter.com/acka47">@acka47</a> &amp;
							<a href="http://www.dr0i.de/">Pascal Christoph</a> /
							<a href="https://twitter.com/dr0ide">@dr0ide</a> <br/>
							<a href="http://lobid.org/team">Linked Open Data, Hochschulbibliothekszentrum NRW (hbz)</a> </small> <br/>
						<a href="https://lobid.org"><img src="img/lobid.png" style="border: none; padding: 5px; background-color: white" width="125px" /></a><br/>
						<small>Bonn, 2018-11-26</small>
					</p>
					<p>
						This presentation: <br /> <a
							href="http://hbz.github.io/swib18-workshop">http://hbz.github.io/swib18-workshop</a>
						<br/>
						<a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="img/cc-by.png" title="Licensed under a Creative Commons Attribution 4.0 International License"></a>
					</p>
				</section>

				<section data-state="adrian">
					<h2>Overview</h2>
					<table>
						<tr><th width="25%"/><th width="50%"/><th width="25%"/></tr>
						<tr><td><b>Part I</b></td><td>Convert RDF data into usable JSON-LD</td><td>13:15-15:00</td></tr>
						<tr><td><b>Part II</b></td><td>Index and access the data with Elasticsearch</td><td>15:00-16:30</td></tr>
						<tr><td><b><i>Break</i></b></td><td><i>Cake</i></td><td><i>15:30-16:00</i></td></tr>
						<tr><td><b>Part III</b></td><td>Use the data to build a web application</td><td>16:30-17:30</td></tr>
						<tr><td><b>Part IV</b></td><td>Use the data in existing tools: Kibana, OpenRefine</td><td>17:30-18:45</td></tr>
					</table>
				</section>

				<section data-state="adrian">
					<h1>Our background &amp; experience</h1>
				</section>

				<section data-state="adrian">
					<img src="img/hbz.png" style="border: none; box-shadow: none;background-color: white; height: 100px; padding:10px" />
					<p><span class="fragment">Hochschulbibliothekszentrum des Landes Nordrhein-Westfalen, est. 1973</span></p>
					<p><span class="fragment">= Academic library center of North Rhine-Westphalia</span></p>
					<p><span class="fragment">Software services for libraries in NRW and beyond</span></p>
					<p><span class="fragment">E.g. union catalog, discovery portal DigiBib, ILL, digitization & digital preservation, consortial acquisition</span></p>
					<p><span class="fragment">SWIB co-organizer</span></p>
					<p><span class="fragment"><a href="https://www.hbz-nrw.de/service/mediathek/flyer/hbz-product-scope/at_download/file">hbz flyer in English (PDF)</a></span></p>
				</section>

				<section data-state="adrian">
					<img src="img/lobid.png" style="border: none; box-shadow: none;background-color: white; height: 100px; padding:10px" />
					<p><span class="fragment">lobid: hbz's LOD service, providing bibliographic data, authorities &amp; organizations</span></p>
					<p><span class="fragment">Started 2010 with open data publication, triple store &amp; Perl transformation script</span></p>
					<p><span class="fragment">Original team: Adrian, Pascal, Felix. Fabian joined in 2012.</span></p>
					<p><span class="fragment">2013: First API release based on JSON-LD &amp; Elasticsearch</span></p>
					<p><span class="fragment">2017&ndash;2018: LOUD with lobid API 2.0</span></p>
					<span class="fragment"><h4><a href="http://lobid.org/team">http://lobid.org/team</a> | <a href="http://blog.lobid.org">http://blog.lobid.org</a></h4></span>
				</section>

				<section data-state="adrian">
					<h1>Your background &amp; experience</h1>
					<span class="fragment"><p>RDF?</p></span>
					<span class="fragment"><p>Bulk data processing?</p></span>
					<span class="fragment"><p>Command line?</p></span>
					<span class="fragment"><p>Software development?</p></span>
				</section>

				<section data-state="adrian">
					<h2>LOUD</h2>
					<a href="https://twitter.com/azaroth42/status/768140561794502656"><img src="img/loud-tweet.png" style="border: none; box-shadow: none;background-color: white; width: 700px; padding:10px" /></a>
					<span class="fragment"><p>Term coined by Robert Sanderson in 2016 (see also his <a href="https://de.slideshare.net/azaroth42/community-challenges-for-practical-linked-open-data-linked-pasts-keynote">Linked Pasts Keynote</a>)</p></span>
				</section>

				<section data-state="adrian">
					<h2>Linked Open Usable Data (LOUD)</h2>
					<span class="fragment"><p>Core idea: to make your data useful you have to know and cater to your audience</p></span>
					<span class="fragment"><p>Primary audience of LOD: people developing (1st and 2nd party) or using (3rd party) <i>software</i> to access the data</p></span>
					<span class="fragment"><p>LOUD: oriented towards the needs and conventions for developing software</p></span>
				</section>

				<section data-state="adrian">
					<a href="https://www.slideshare.net/azaroth42/europeanatech-keynote-shout-it-out-loud/22"><img src="img/sanderson-2018-loud-22.png" width=800 /></a>
					<p><font size="3">Source: <a href="https://www.slideshare.net/azaroth42/europeanatech-keynote-shout-it-out-loud">Rob Sanderson, "Shout it Out: LOUD"</a>, CC-BY (<a href="https://youtu.be/r4afi8mGVAY?t=1112">video</a>)</font></p>
				</section>

				<section data-state="adrian">
					<a href="https://www.slideshare.net/azaroth42/europeanatech-keynote-shout-it-out-loud/22"><img src="img/sanderson-2018-loud-32.png" width=800 /></a>
					<p><font size="3">Source: <a href="https://www.slideshare.net/azaroth42/europeanatech-keynote-shout-it-out-loud">Rob Sanderson, "Shout it Out: LOUD"</a>, CC-BY (<a href="https://youtu.be/r4afi8mGVAY?t=1910">video</a>)</font></p>
				</section>

				<section data-state="adrian">
					<h2>Design for JSON-LD <br/><i>from RDF</i>, consistently</h2>
					<span class="fragment"><p>(Our background &amp; this workshop: we start with RDF data)</p></span>
				</section>

				<section data-state="fabian">
					<h2>Part I:<br><small>Convert RDF data into usable JSON-LD</small></h2>
					<table>
						<tr><th width="38%"/><th width="39%"/><th width="25%"/></tr>
						<tr><td><b>Usable data & APIs</b></td><td>Application Programming Interfaces: why, how</td><td>13:00-13:15</td></tr>
						<tr><td><b>JSON APIs</b></td><td>Using the GitHub API, processing JSON</td><td>13:15-14:00</td></tr>
						<tr><td><b>From RDF to JSON</b></td><td>JSON-LD processing with jsonld.js via jsonld-cli</td><td>14:00-15:00</td></tr>
					</table>
				</section>

				<section data-state="fabian">
					<p>Part Ia.</p>
					<blockquote><h2>Usable data & APIs</h2></blockquote>
					<blockquote><h2>APIs: why, how</h2></blockquote>
				</section>

				<section data-state="fabian">
					<blockquote><p>Usable data [& APIs]</p></blockquote>
					<span class="fragment"><h1>Data is used with software</h1></span>
					<span class="fragment"><p>Build new software with the data</p></span>
					<span class="fragment"><p>Use existing software with the data</p></span>
				</section>

				<section data-state="fabian">
					<h1>Libraries are Software</h1>
					<blockquote>Our collections and services are delivered primarily via software. [...] The choices we make in the development, 
					selection, and implementation of this software [...] define the limits of our content and services. We can only be as good as our software.</blockquote>
					<blockquote> &mdash; Cody Hanson, <a href="http://codyhanson.com/writing/software.html">Libraries are Software</a></blockquote>
				</section>

				<section data-state="fabian">
					<blockquote><p>[Usable data &] APIs</p></blockquote>
					<span class="fragment"><h1>Software <br/>requires APIs</h1></span>
					<span class="fragment"><h4>APIs make software development manageable <br/>(for 1st and 2nd party software)</h4></span>
					<span class="fragment"><h4>APIs enable usage and integration of 3rd party software</h4></span>
				</section>

				<section data-state="fabian">
					<h3>e.g. lobid sources, formats, applications</h3>
					<img src="img/data.png" style="border: none; box-shadow: none;" /> <span
						class="fragment"><h4>APIs decouple applications from
							specific data sources, formats, and systems. They enable modular, sustainable applications.</h4></span>
				</section>

				<section data-state="fabian">
					<blockquote><h1>API: why?</h1></blockquote>
					<span class="fragment"><blockquote><p><a href='https://www.slideshare.net/azaroth42/europeanatech-keynote-shout-it-out-loud/22'>&starf; </a>Right abstraction for the audience</p></blockquote></span>
					<span class="fragment"><blockquote><p>Data is used with software</p></blockquote></span>
					<span class="fragment"><blockquote><p>Software requires APIs</p></blockquote></span>
				</section>

				<section data-state="fabian">
					<blockquote><h1>API: why?</h1></blockquote>
					<span class="fragment"><h1>Usable data <br/>is data with APIs</h1></span>
				</section>

				<section data-state="fabian">
					<blockquote><h1>API: how?</h1></blockquote>
					<span class="fragment"><blockquote><h2><a href='https://www.slideshare.net/azaroth42/europeanatech-keynote-shout-it-out-loud/32'>3. </a>Don't break the web</h2></blockquote></span>
				</section>

				<section data-state="fabian">
					<blockquote><h1>API: how?</h1></blockquote>
					<span class="fragment"><h1>JSON over HTTP</h1></span>
					<span class="fragment"><h3><a href="https://twobithistory.org/2017/09/21/the-rise-and-rise-of-json.html">standard web API format since years</a></h3></span>
					<span class="fragment"><h4>e.g. <a href='https://api.github.com/'> https://api.github.com/</a></h4></span>
				</section>

				<section data-state="fabian">
					<h2>GET https://api.github.com</h2>
					<pre><code class="json" data-trim>
{
  "current_user_url": "https://api.github.com/user",
  "authorizations_url": "https://api.github.com/authorizations",
  "emails_url": "https://api.github.com/user/emails",
  "emojis_url": "https://api.github.com/emojis",
  "events_url": "https://api.github.com/events",
  "feeds_url": "https://api.github.com/feeds",
  "followers_url": "https://api.github.com/user/followers",
  "gists_url": "https://api.github.com/gists{/gist_id}",
  "hub_url": "https://api.github.com/hub",
  ...
}
					</code></pre>
				</section>

				<section data-state="fabian">
					<p>Part Ib.</p>
					<blockquote><h2>JSON APIs</h2></blockquote>
					<blockquote><h2>Using the GitHub API, processing JSON</h2></blockquote>
				</section>

				<section data-state="pascal">
					<h1>Setup</h1>
					<span class="fragment"><p><a href='https://github.com/hbz/swib18-workshop#setup'>https://github.com/hbz/swib18-workshop#setup</a></p></span>
					<span class="fragment"><p>($ git pull origin master)</p></span>
				</section>

				<section data-state="fabian">
					<h1>cURL</h1>
					<p><span class="fragment">Command line tool for transferring data with URLs</span></p>
					<p><span class="fragment"><a href="https://curl.haxx.se/download.html" target="_blank">https://curl.haxx.se/download.html</a></span></p>
					<span class="fragment">
						<pre><code class="bash">$ curl --help</code></pre>
						<p><font size="5">('$' <i>means you should type this in your terminal application</i>)</font></p>
					</span>
				</section>

					<section data-state="fabian">
						<h2>Exercise 1a: cURL</h2>
							<table style="border: 1px solid white; table-layout:fixed; width: 100%">
								<col width="10%" />
								<col width="90%" />
								<tbody>
									<tr>
										<td>cURL</td>
										<td>
											<pre><code class="bash" data-trim>
$ curl https://api.github.com
											</code></pre>
										</td>
									</tr>
									<tr>
										<td>Paste</td>
										<td>
											<pre><code class="bash" data-trim>
# Copy above, paste in terminal
$ curl https://api.github.com
											</code></pre>
										</td>
									</tr>
									<tr>
										<td>History</td>
										<td>
											<pre><code class="bash" data-trim>
$ &uarr; # access the history
$ curl https://api.github.com
											</code></pre>
										</td>
									</tr>
								</tbody>
							</table>
						<p><font size="5"><i>(You can copy and paste in the terminal with Shift+Ctrl+C and Shift+Ctrl+V)</i></font></p>
					</section>

					<section data-state="fabian">
						<h2>Exercise 1b: cURL</h2>
							<table style="border: 1px solid white; table-layout:fixed; width: 100%">
								<col width="10%" />
								<col width="90%" />
								<tbody>
									<tr>
										<td>Profile</td>
										<td>
											<pre><code class="bash" data-trim>
$ curl https://api.github.com/&lt;???&gt; # user or org
											</code></pre>
										</td>
									</tr>
									<tr>
										<td>Repo</td>
										<td>
											<pre><code class="bash" data-trim>
$ curl https://api.github.com/&lt;???&gt;
											</code></pre>
										</td>
									</tr>
								</tbody>
							</table>
					<p><font size="5">('&lt;???&gt;' <i>means you should insert your solution here</i>)</font></p>
					<p>We have a repo for this workshop called 'swib18-workshop' under the 'hbz' organization</p>
					</section>

					<section data-state="fabian">
						<h2>Exercise 1c: cURL<br/> Solution</h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
								<col width="10%" />
								<col width="90%" />
								<tbody>
									<tr>
										<td>Profile</td>
										<td>
											<pre><code class="bash" data-trim>
$ curl https://api.github.com/users/hbz
											</code></pre>
										</td>
									</tr>
									<tr>
										<td>Repo</td>
										<td>
											<pre><code class="bash" data-trim>
$ curl https://api.github.com/repos/hbz/swib18-workshop
											</code></pre>
										</td>
									</tr>
								</tbody>
							</table>
					</code></pre>
					<p><font size="5">('$' <i>means you should type this in your terminal application</i>)</font></p>
					</section>

					<section data-state="fabian">
						<h2>Response</h2>
						<pre><code class="json" data-trim>
$ curl https://api.github.com/repos/hbz/swib18-workshop
{
  "id": 150073510,
  "node_id": "MDEwOlJlcG9zaXRvcnkxNTAwNzM1MTA=",
  "name": "swib18-workshop",
  "full_name": "hbz/swib18-workshop",
  "private": false,
  "owner": {
    "login": "hbz",
    "id": 6557108,
    "node_id": "MDEyOk9yZ2FuaXphdGlvbjY1NTcxMDg=",
    "avatar_url": "https://avatars3.githubusercontent.com/u/6557108?v=4",
    "gravatar_id": "",
						</code></pre>
						<p>Output is quite long, we often want specific values</p>
					</section>

					<section data-state="fabian">
						<h2>JavaScript Object Notation (JSON)</h2>
						<span class="fragment"><pre><code class="javascript" data-trim>
var options = {
  url: 'https://api.github.com/repos/hbz/swib18-workshop',
  headers: { 'User-Agent': 'hbz' }
};

request(options, function (error, response, body) {
  var doc = JSON.parse(body);
  console.log('repo license:', doc.license.name) // <-- use JSON
});
						</code></pre></span>
						<span class="fragment"><pre><code class="nohighlight" data-trim>
> license.name: Creative Commons Attribution 4.0 International
						</code></pre></span>
					</section>

					<section data-state="fabian">
						<h1>jq</h1>
						<p><span class="fragment">A lightweight and flexible command-line JSON processor</span></p>
						<p><span class="fragment"><a href="https://stedolan.github.io/jq/" target="_blank">https://stedolan.github.io/jq/</a></span></p>
						<p><span class="fragment"><a href="https://jqplay.org/">https://jqplay.org/</a></span></p>
						<span class="fragment">
							<pre><code class="bash">$ jq --help</code></pre>
							<p><font size="5">('$' <i>means you should type this in your terminal application</i>)</font></p>
						</span>
					</section>

					<section data-state="fabian">
						<h2>Exercise 2a: JSON with jq</h2>
						<pre><code class="bash" data-trim>
$ curl https://api.github.com/repos/hbz/swib18-workshop \
| jq .name # filter: .name
						</code></pre>
						<p><font size="5">('$' <i>means you should type this in your terminal application</i>)</font></p>
					</section>

					<section data-state="fabian">
						<h2>Exercise 2b: JSON with jq</h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
							<col width="10%" />
							<col width="90%" />
							<tbody>
								<tr>
									<td>Issues</td>
									<td>
										<pre><code class="bash" data-trim>
$ curl https://api.github.com/repos/hbz/swib18-workshop | jq &lt;???&gt; # get the number of open issues
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>License</td>
									<td>
										<pre><code class="bash" data-trim>
$ curl https://api.github.com/repos/hbz/swib18-workshop | jq &lt;???&gt; # get the repo's license name
										</code></pre>
									</td>
								</tr>
							</tbody>
						</table>
						<p><font size="5">('&lt;???&gt;' <i>means you should insert your solution here</i>)</font></p>
					</section>

					<section data-state="fabian">
						<h2>Exercise 2c: JSON with jq</h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
							<col width="10%" />
							<col width="90%" />
							<tbody>
								<tr>
									<td>Issues</td>
									<td>
										<pre><code class="bash" data-trim>
$ curl https://api.github.com/repos/hbz/swib18-workshop | jq .open_issues_count
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>License</td>
									<td>
										<pre><code class="bash" data-trim>
$ curl https://api.github.com/repos/hbz/swib18-workshop | jq .license.name
										</code></pre>
									</td>
								</tr>
							</tbody>
						</table>
						<p><font size="5">('$' <i>means you should type this in your terminal application</i>)</font></p>
					</section>

					<section data-state="fabian">
						<h1>So JSON is great.</h1>
						<span class="fragment"><h1>But what if we have <a href="http://id.loc.gov/download/">RDF</a> data?</h1></span>
					</section>

					<section data-state="fabian">
						<p>Part Ic.</p>
						<blockquote><h2>From RDF to JSON</h2></blockquote>
						<blockquote><h2>JSON-LD processing with jsonld.js via jsonld-cli</h2></blockquote>
					</section>

					<section data-state="adrian">
						<h2>Bibframe datasets (N-Triples)</h2>
						<a href="http://id.loc.gov/download/"><img src="img/loc-downloads.png" style="border: none; box-shadow: none;" /></a>
					</section>

					<section data-state="adrian">
						<a href="https://listserv.loc.gov/cgi-bin/wa?A2=BIBFRAME;3141fdaf.1806"><img src="img/bibframe-bulk-email.png" style="border: none; box-shadow: none;" /></a>
					</section>

					<section data-state="adrian">
						<h2>Example work</h2>
						<a href="http://rdf-translator.appspot.com/convert/nt/nt/html/https%3A%2F%2Fraw.githubusercontent.com%2Fhbz%2Fswib18-workshop%2Fmaster%2Fdata%2Floc.nt"><img src="img/nt.png" style="border: none; box-shadow: none;" /></a>
						<small>Source file: <a href="https://github.com/hbz/swib18-workshop/blob/master/data/loc.nt">https://github.com/hbz/swib18-workshop/blob/master/data/loc.nt</a></small>
					</section>

					<section data-state="fabian">
						<h1>JSON-LD</h1>
						<span class="fragment"><p>&quot;designed to be usable directly as JSON, with no knowledge of RDF&quot; &mdash; it's real JSON!</p></span>
						<span class="fragment"><p>&quot;also designed to be usable as RDF&quot;</p></span>
						<span class="fragment"><p><a href="https://www.w3.org/TR/json-ld/">https://www.w3.org/TR/json-ld/</a></p></span>
					</section>

					<section data-state="fabian">
						<h1><blockquote><a href='https://www.slideshare.net/azaroth42/europeanatech-keynote-shout-it-out-loud/32'>5. </a>Design for JSON-LD, consistently</blockquote></h1>
					</section>

					<section data-state="fabian">
						<h1>Great, so let's make JSON-LD from RDF</h1>
					</section>

					<section data-state="fabian">
						<h1>jsonld-cli</h1>
						<p><span class="fragment">JSON-LD command line interface tool</span></p>
						<p><span class="fragment"><a href="https://github.com/hbz/jsonld-cli" target="_blank">https://github.com/hbz/jsonld-cli</a></span></p>
						<p><span class="fragment">Our fork of https://github.com/digitalbazaar/jsonld-cli, added import from N-Quads</p>
						<span class="fragment">
							<pre><code class="bash">$ jsonld --help</code></pre>
							<p><font size="5">('$' <i>means you should type this in your terminal application</i>)</font></p>
						</span>
					</section>

					<section data-state="fabian">
						<h2>Exercise 3:<br/>N-Triples to JSON-LD</h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
							<col width="20%" />
							<col width="80%" />
							<tbody>
								<tr>
									<td>Location</td>
									<td>
										<pre><code class="bash" data-trim>
$ cd ~/git/swib18-workshop/data
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Import</td>
									<td>
										<pre><code class="bash" data-trim>
$ jsonld import loc.nt
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Write</td>
									<td>
										<pre><code class="bash" data-trim>
$ jsonld import loc.nt > loc.json
										</code></pre>
									</td>
								</tr>
							</tbody>
						</table>
						<p><font size="5">('$' <i>means you should type this in your terminal application</i>)</font></p>
					</section>

					<section data-state="fabian">
					<h2>Result</h2>
					<pre><code class="json" data-trim>
{
 "@id": "http://id.loc.gov/resources/works/c000101650",
 "http://id.loc.gov/ontologies/bibframe/subject": [{
  "@id": "http://id.loc.gov/resources/works/101650#Topic650-20"
 }, ...]
}, {
 "@id": "http://id.loc.gov/resources/works/101650#Topic650-20",
 "@type": [
  "http://id.loc.gov/ontologies/bibframe/Topic",
  "http://www.loc.gov/mads/rdf/v1#ComplexSubject"
 ],
 "http://www.w3.org/2000/01/rdf-schema#label": [{
  "@value": "Climatic changes--Europe."
 }],...
}
					</code></pre>
					<p><a href='http://hbz.github.io/swib18-workshop/data/index.html#jsonld-output'>Serialized RDF as JSON-LD</a> | <a href='https://www.w3.org/TR/json-ld11-api/#serialize-rdf-as-json-ld-algorithm'>Specification</a></p>
					</section>

					<section data-state="fabian">
						<h2>Exercise 3a:<br/><small>Use serialized RDF to access subjects</small></h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
							<col width="15%" />
							<col width="85%" />
							<tbody>
								<tr>
									<td>Identify field</td>
									<td>
										<pre><code class="bash" data-trim>
$ cat loc.json | less
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Access field</td>
									<td>
										<pre><code class="bash" data-trim>
# like .license.name, but for subject labels?
$ cat loc.json | jq &lt;???&gt;
										</code></pre>
									</td>
								</tr>
							</tbody>
						</table>
						<span class="fragment"><p>`http://www.w3.org/2000/01/rdf-schema#label`.`@value`?</p></span>
						<span class="fragment"><p>Can't work: we have just a flat array of objects, which label?</p></span>
						<span class="fragment"><p>Problem: only <i>technically</i> JSON, but not <i>usable</i></p></span>
					</section>

					<section data-state="fabian">
						<blockquote><p>So JSON is great?</p></blockquote>
						<span class="fragment"><h1>Worst of both worlds</h1></span>
						<span class="fragment"><p>Unwieldy URIs as keys from RDF</p></span>
						<span class="fragment"><p>Syntactic overhead from JSON</p></span>
						<span class="fragment"><p>Bad readability &amp; usability</p></span>
					</section>

					<section data-state="fabian">
					<h2>Result</h2>
					<pre><code class="json" data-trim>
{
 "@id": "http://id.loc.gov/resources/works/c000101650",
 "http://id.loc.gov/ontologies/bibframe/subject": [{
  "@id": "http://id.loc.gov/resources/works/101650#Topic650-20"
 }, ...]
}, {
 "@id": "http://id.loc.gov/resources/works/101650#Topic650-20",
 "@type": [
  "http://id.loc.gov/ontologies/bibframe/Topic",
  "http://www.loc.gov/mads/rdf/v1#ComplexSubject"
 ],
 "http://www.w3.org/2000/01/rdf-schema#label": [{
  "@value": "Climatic changes--Europe."
 }],...
}
					</code></pre>
					<p><a href='http://hbz.github.io/swib18-workshop/data/index.html#jsonld-output'>Serialized RDF as JSON-LD</a> | <a href='https://www.w3.org/TR/json-ld11-api/#serialize-rdf-as-json-ld-algorithm'>Specification</a></p>
					</section> 

					<section data-state="fabian">
						<h2>Data processing vs. API access</h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
							<col width="17%" />
							<col width="83%" />
							<tbody>
								<tr>
									<td>Data processing</td>
									<td>
										<pre><code class="javascript" data-trim>
for o in doc :
		if o["@type"] contains "http://id.loc.gov/ontologies/bibframe/Topic" :
			subjectId = o["http://id.loc.gov/ontologies/bibframe/subject"][0]["@id"] // + error handling

for o in doc :
	if o["@id"] == subjectId :
		subjectLabel = o["http://www.w3.org/2000/01/rdf-schema#label"]["@value"] // + error handling
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>API access</td>
									<td>
										<pre><code class="javascript" data-trim>
doc.license.name // doc.subject.label?
										</code></pre>
									</td>
								</tr>
							</tbody>
						</table>
					</section>

					<section data-state="fabian">
						<h1>Developer empathy</h1>
						<span class="fragment"><blockquote>
							When it comes to APIs, developers are your users. The same principles of user-centred-design apply 
							to the development and publication of APIs (simplicity, obviousness, fit-for-purpose etc).
							<small><br/><a href='https://apiguide.readthedocs.io/en/latest/principles/empathy.html'>API Design Guide, Digital Transformation Agency, Australia</a></small></blockquote>
						</span>
					</section>

					<section data-state="fabian">
						<h1>Non-developer empathy</h1>
						<span class="fragment"><p>Default RDF -> JSON-LD <i>requires</i> programming with loops &amp; conditionals to access a single nested field, the subject label</p></span>
						<span class="fragment"><p>Should be as simple as <i>doc.license.name</i></p></span>
						<span class="fragment"><p>Not providing an API actually <i>excludes</i> non-developers by putting up barriers for usage with CLI or GUI tools</p></span>
					</section>

					<section data-state="fabian">
						<blockquote><h1><a href='https://www.slideshare.net/azaroth42/europeanatech-keynote-shout-it-out-loud/22'>&starf; </a>Few barriers to entry</h1></blockquote>
					</section>

					<section data-state="fabian">
						<h1><blockquote>Design for JSON-LD from RDF, consistently</blockquote></h1>
					</section>

					<section data-state="fabian">
						<h1>Framing</h1>
						<span class="fragment"><p>Frame the way we look at our graph from the perspective of one entity type (to make it a tree, or a document)</p></span>
						<span class="fragment"><p>Look at my data from a "Work" perspective, and embed other entities under their works</p></span>
					</section>

					<section data-state="fabian">
						<h2>Exercise 4:<br/>Framing</h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
							<col width="10%" />
							<col width="90%" />
							<tbody>
								<tr>
									<td>frame .json</td>
									<td>
										<pre><code class="javascript" data-trim>
{
 "@type": "http://id.loc.gov/ontologies/bibframe/Work",
 "@embed": "@always"
}
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Frame</td>
									<td>
										<pre><code class="bash" data-trim>
$ jsonld frame -f frame.json loc.json
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Write</td>
									<td>
										<pre><code class="bash" data-trim>
$ jsonld frame -f frame.json loc.json > loc-framed.json
										</code></pre>
									</td>
								</tr>
							</tbody>
						</table>
						<p><font size="5">('$' <i>means you should type this in your terminal application</i>)</font></p>
					</section>

					<section data-state="fabian">
					<h2>Result</h2>
					<pre><code class="json" data-trim>
{
 "@id": "http://id.loc.gov/resources/works/c000101650",
 "http://id.loc.gov/ontologies/bibframe/subject": [{
   "@id":"http://id.loc.gov/resources/works/101650#Topic650-20",
   "@type": [
     "http://id.loc.gov/ontologies/bibframe/Topic",
     "http://www.loc.gov/mads/rdf/v1#ComplexSubject"
   ],
   ...
   "http://www.w3.org/2000/01/rdf-schema#label": "Climatic changes--Europe."
 }, {...}],
}
					</code></pre>
					<p><a href='http://hbz.github.io/swib18-workshop/data/index.html#jsonld-framed'>Framed JSON-LD</a> | <a href='https://www.w3.org/TR/json-ld11/#framed-document-form'>Specification</a></p>
					</section>

					<section data-state="fabian">
						<h2>Exercise 4a:<br/><small>Use framed JSON-LD to access subjects</small></h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
							<col width="13%" />
							<col width="87%" />
							<tbody>
								<tr>
									<td>Identify field</td>
									<td>
										<pre><code class="bash" data-trim>
$ cat loc-framed.json | less
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Access field</td>
									<td>
										<pre><code class="bash" data-trim>
# like .license.name, but for subject labels?
$ cat loc-framed.json | jq &lt;???&gt;
										</code></pre>
									</td>
								</tr>
							</tbody>
						</table>
						<span class="fragment"><p>`http://id.loc.gov/ontologies/bibframe/subject`<br/>.`http://www.w3.org/2000/01/rdf-schema#label`?</p></span>
						<span class="fragment"><p>Could work conceptually, but not very handy</p></span>
					</section>

					<section data-state="fabian">
						<blockquote><h1><a href='https://www.slideshare.net/azaroth42/europeanatech-keynote-shout-it-out-loud/32'>2. </a>As simple as possible?</h1></blockquote>
					</section>

					<section data-state="fabian">
						<h1>JSON-LD Context</h1>
						<span class="fragment"><p>Mapping of JSON keys to URIs: <br/><code>"@context":{"name":"http://schema.org/name"}</code></p></span>
						<span class="fragment"><p>With this context, we can <a href='https://www.w3.org/TR/json-ld11-api/#compaction'>compact</a> (replace URIs with short keys) or 
						<a href='https://www.w3.org/TR/json-ld11-api/#expansion'>expand</a> (replace short keys with URIs) our JSON-LD</p></span>
						<span class="fragment"><p>http://schema.org/name &rlarr; name</p></span>
						<span class="fragment"><p>`http://id.loc.gov/ontologies/bibframe/subject`<br/>.`http://www.w3.org/2000/01/rdf-schema#label`?</p></span>
					</section>

					<section data-state="adrian">
						<h1>How do we get the context?</h1>
						<span class="fragment"><p><a href="https://twitter.com/lobidOrg/status/1044866797067997184">Does LOC or somebody else already provide one?</a> – No.</p></span>
						<span class="fragment"><p><a href="https://github.com/hbz/swib18-workshop/issues/2#issuecomment-424710995">Here: context generated from ontologies</a>  with (much) manual post-processing</p></span>
						<span class="fragment"><p>Alternatives: upfront design or generate from data</p></span>
						<span class="fragment"><p>To be discussed in JSON-LD break-out session</p></span>
					</section>

					<section data-state="fabian">
						<h1>Context: more than simple mappings</h1>
						<span class="fragment"><p><blockquote><a href='https://www.slideshare.net/azaroth42/europeanatech-keynote-shout-it-out-loud/22'>&starf;</a> Few exceptions, many consistent patterns</blockquote></p></span>
					</section>

					<section data-state="fabian">
						<h1>Consistency</h1>
						<span class="fragment"><p>e.g. the <i>contribution</i> field should always be an array, even if a particular record has only one contribution | <a href='https://www.w3.org/TR/json-ld11/#sets'>spec</a></p></span>
						<span class="fragment"><p>Other fields, which occur only once for every record can use the default non-array single values</p></span>
						<span class="fragment"><p>To have all fields always be arrays: compacting option <a href='https://www.w3.org/TR/json-ld11-api/#dom-jsonldoptions-compactarrays'>compactArrays:false</a></p></span>
						<span class="fragment"><p><small>(Consistent field types also required for Elasticsearch indexing)</small></p></span>
					</section>

					<section data-state="fabian">
						<h1>Describing values</h1>
						<span class="fragment"><p>e.g. field 'contribution' should always be a JSON array</p></span>
						<span class="fragment"><pre><code class="javascript" data-trim>
"contribution": {
  "@id": "http://id.loc.gov/ontologies/bibframe/contribution",
  "@container": "@set"
}
						</pre></code></span>
						<span class="fragment"><p><a href="https://www.w3.org/TR/json-ld11/#describing-values">See context specification for details</a></p></span>
					</section>

					<section data-state="fabian">
						<h2>Exercise 5:<br/>Compact</h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
							<col width="15%" />
							<col width="85%" />
							<tbody>
								<tr>
									<td>Compact</td>
									<td>
										<pre><code class="bash" data-trim>
$ jsonld compact -c context.json loc-framed.json
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Write</td>
									<td>
										<pre><code class="bash" data-trim>
$ jsonld compact -c context.json loc-framed.json > loc-compact.json
										</code></pre>
									</td>
								</tr>
							</tbody>
						</table>
						<p><font size="5">('$' <i>means you should type this in your terminal application</i>)</font></p>
					</section>

					<section data-state="fabian">
					<h2>Result</h2>
					<pre><code class="json" data-trim>
{
 "@id": "http://id.loc.gov/resources/works/c000101650",
 "subject": [
  {
   "id": "http://id.loc.gov/resources/works/101650#Topic650-20",
   "type": [
    "Topic",
    "ComplexSubject"
   ],
   "label": "Climatic changes--Europe."
  }
 ], ...
}
					</code></pre>
					<p><a href='http://hbz.github.io/swib18-workshop/data/index.html#jsonld-compact'>Compacted JSON-LD</a> | <a href='https://www.w3.org/TR/json-ld11/#compacted-document-form'>Specification</a></p>
					</section>

					<section data-state="fabian">
						<h2>Exercise 5a:<br/><small>Use compact JSON-LD to access subjects</small></h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
							<col width="13%" />
							<col width="87%" />
							<tbody>
								<tr>
									<td>Identify field</td>
									<td>
										<pre><code class="bash" data-trim>
$ cat loc-compact.json | less
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Full Title</td>
									<td>
										<pre><code class="bash" data-trim>
$ cat loc-compact.json | jq .label
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Subject</td>
									<td>
										<pre><code class="bash" data-trim>
# like .license.name, but for subject labels?
$ cat loc-compact.json | jq &lt;???&gt;
										</code></pre>
									</td>
								</tr>
							</tbody>
						</table>
						<p><font size="5">('$' <i>means you should type this in your terminal application</i>)</font></p>
					</section>

					<section data-state="fabian">
						<h2>Exercise 5a:<br/><small>Solution</small></h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
							<col width="13%" />
							<col width="87%" />
							<tbody>
								<tr>
									<td>like .license .name?</td>
									<td>
										<pre><code class="nohighlight" data-trim>
$ cat loc-compact.json | jq .subject.label

jq: error: Cannot index array with string "label"
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Access one</td>
									<td>
										<pre><code class="bash" data-trim>
$ cat loc-compact.json | jq .subject[0].label
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Access all</td>
									<td>
										<pre><code class="bash" data-trim>
$ cat loc-compact.json | jq .subject[].label
										</code></pre>
									</td>
								</tr>
							</tbody>
						</table>
						<p><font size="5">('$' <i>means you should type this in your terminal application</i>)</font></p>
					</section>

					<section data-state="fabian">
						<h1>Missing values in context</h1>
						<span class="fragment"><p>Un-mapped URI in the data</p></span>
						<span class="fragment"><p>Will still be URI after compaction</p></span>
						<span class="fragment"><p>Iterate: compact, check data, fix context, compact again</p></span>
					</section>

					<section data-state="fabian">
						<h2>Exercise 5b: Fix context</h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
							<col width="20%" />
							<col width="88%" />
							<tbody>
								<tr>
									<td>Check paths</td>
									<td>
										<pre><code class="bash" data-trim>
$ cat loc-compact.json | jq -c 'path(..)'
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Find URIs</td>
									<td>
										<pre><code class="bash" data-trim>
$ cat loc-compact.json | jq -c 'path(..)' | grep http
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Update context</td>
									<td>
										<pre><code class="json" data-trim>
"value" : "http://www.w3.org/1999/02/22-rdf-syntax-ns#value"
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Compact</td>
									<td>
										<pre><code class="bash" data-trim>
$ jsonld compact -c context.json loc-framed.json > loc-compact.json
										</code></pre>
									</td>
								</tr>
							</tbody>
						</table>
						<p><font size="5">('$' <i>means you should type this in your terminal application</i>)</font></p>
					</section>

					<section data-state="fabian">
						<h2>Exercise 6: Use final JSON</h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
							<col width="20%" />
							<col width="88%" />
							<tbody>
								<tr>
									<td>Identify fields</td>
									<td>
										<pre><code class="bash" data-trim>
$ cat loc-compact.json | less
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Authors</td>
									<td>
										<pre><code class="bash" data-trim>
$ cat loc-compact.json | jq &lt;???&gt; # get authors
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Subtitle</td>
									<td>
										<pre><code class="bash" data-trim>
$ cat loc-compact.json | jq &lt;???&gt; # get subtitle
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>To N-Quads</td>
									<td>
										<pre><code class="bash" data-trim>
$ jsonld format -q data/loc-compact.json
										</code></pre>
									</td>
								</tr>
							</tbody>
						</table>
						<p><font size="5">('$' <i>means you should type this in your terminal application</i>)</font></p>
					</section>

					<section data-state="fabian">
						<h2>Exercise 6: Solutions</h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
							<col width="10%" />
							<col width="90%" />
							<tbody>
								<tr>
									<td>Authors</td>
									<td>
										<pre><code class="bash" data-trim>
$ cat loc-compact.json | jq .contribution[].agent.label
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Subtitle</td>
									<td>
										<pre><code class="bash" data-trim>
$ cat loc-compact.json | jq .title.subtitle
										</code></pre>
									</td>
								</tr>
							</tbody>
						</table>
						<p><font size="5">('$' <i>means you should type this in your terminal application</i>)</font></p>
					</section>

					<section data-state="fabian">
						<blockquote><p>So JSON is great</p></blockquote>
						<span class="fragment"><h1>Best of both worlds</h1></span>
						<span class="fragment"><p>RDF-compatible linked data</p></span>
						<span class="fragment"><p>Useful, practical JSON</p></span>
					</section>

					<section data-state="fabian">
						<h2>RDF view</h2>
						<span class="fragment"><p>Multiple steps to make usable JSON-LD</p></span>
						<span class="fragment"><p>Serialize RDF as JSON-LD, frame, compact</p></span>
					</section>

					<section data-state="fabian">
						<blockquote><h1><a href='https://www.slideshare.net/azaroth42/europeanatech-keynote-shout-it-out-loud/32'>1. </a>Require use cases, with data</h1></blockquote>
					</section>

					<section data-state="fabian">
						<h2>JSON view</h2>
						<span class="fragment"><p>Add context to usable JSON</p></span>
						<span class="fragment"><p>(Add <code>@id</code>s where needed)</p></span>
					</section>

					<section data-state="fabian">
						<h2>Context maps stable API to implementation details</h2>
						<span class="fragment"><p>Applications can use the '<code>name</code>' field in their code, no matter what URI it's mapped to (which unfortunately may change)</p></span>
					</section>

					<section data-state="fabian">
					<h2>JSON with context</h2>
					<p>(based on part of <a href='https://api.github.com/users/hbz'>https://api.github.com/users/hbz</a>)</p>
					<pre><code class="json" data-trim>
{
  "@id": "https://github.com/users/hbz",
  "type": "Organization",
  "name": "hbz",
  "blog": "https://www.hbz-nrw.de",

  "@context": {
    "type": "@type",
    "name": "https://schema.org/name",
    "blog": { "@id": "https://schema.org/url", "@type": "@id" },
    "Organization": "https://schema.org/Organization"
  }
}
					</code></pre>
					<p>You can test this in the <a href='https://json-ld.org/playground/'>JSON-LD Playground</a></p>
					</section>

					<section data-state="fabian">
					<blockquote><h2>JSON as RDF</h2></blockquote>
					<pre><code class="json" data-trim>
{
  "@context": "...",
  "type": "Organization",
  "name": "hbz",
  "blog": "https://www.hbz-nrw.de",
}
					</code></pre>
					<pre><code class="nohighlight" data-trim>
&lt;https://github.com/users/hbz&gt; \
&lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; \
&lt;https://schema.org/Organization&gt; .
&lt;https://github.com/users/hbz&gt; &lt;https://schema.org/name&gt; "hbz" .
&lt;https://github.com/users/hbz&gt; &lt;https://schema.org/url&gt; \
&lt;https://www.hbz-nrw.de&gt; .
					</code></pre>
					<p>Output of N-Quads tab in the <a href='https://json-ld.org/playground/'>JSON-LD Playground</a></p>
					</section>

					<section data-state="fabian">
						<p>Part I: Convert RDF data into usable JSON-LD</p>
						<span class="fragment">Part II: Index and access the data with Elasticsearch</span>
					</section>

					<section data-state="fabian">
						<h2>Part II:<br><small>Index and access the data with Elasticsearch</small></h2>
						<table>
							<tr><th width="38%"/><th width="39%"/><th width="25%"/></tr>
							<tr><td><b>Elasticsearch bulk indexing</b></td><td>Create bulk format with jq, index with curl</td><td>15:00-15:30</td></tr>
							<tr><td><b><i>Break</i></b></td><td><i>Cake</i></td><td><i>15:30-16:00</i></td></tr>
							<tr><td><b>Access the Elasticsearch index</b></td><td>Search queries, direct access by ID</td><td>16:00-16:30</td></tr>
						</table>
					</section>

					<section data-state="fabian">
						<p>Part IIa.</p>
						<blockquote><h2>Elasticsearch bulk indexing</h2></blockquote>
						<blockquote><h2>Create bulk format with jq, index with curl</h2></blockquote>
					</section>

					<section data-state="fabian">
						<h1>Elasticsearch</h1>
						<span class="fragment"><p>"A distributed, RESTful search and analytics engine"</p></span>
						<span class="fragment"><p>Based on Lucene, like Solr</p></span>
						<span class="fragment"><p>Stores JSON documents, no explicit schema required</p></span>
						<span class="fragment"><p><a href="https://www.elastic.co/products/elasticsearch">https://www.elastic.co/products/elasticsearch</a></p></span>
					</section>

					<section data-state="fabian">
						<h2>Exercise 7: Convert more data (100 documents)</h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
							<col width="25%" />
							<col width="75%" />
							<tbody>
								<tr>
									<td>Input file</td>
									<td>
										<pre><code class="bash" data-trim>
$ tail loc-100.nt
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Import</td>
									<td>
										<pre><code class="bash" data-trim>
$ jsonld import &lt;???&gt;
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Frame</td>
									<td>
										<pre><code class="bash" data-trim>
$ jsonld frame &lt;???&gt;
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Compact</td>
									<td>
										<pre><code class="bash" data-trim>
$ jsonld compact &lt;???&gt;
										</code></pre>
									</td>
								</tr>
							</tbody>
						</table>
						<p><font size="5">('$' <i>means you should type this in your terminal application</i>)</font></p>
					</section>

					<section data-state="fabian">
						<h2>Exercise 7: Solutions</h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
							<col width="25%" />
							<col width="75%" />
							<tbody>
								<tr>
									<td>Import</td>
									<td>
										<pre><code class="bash" data-trim>
$ jsonld import loc-100.nt > loc-100.json
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Frame</td>
									<td>
										<pre><code class="bash" data-trim>
$ jsonld frame -f frame.json loc-100.json > loc-100-framed.json
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Compact</td>
									<td>
										<pre><code class="bash" data-trim>
$ jsonld compact -c context.json loc-100-framed.json > loc-100-compact.json
										</code></pre>
									</td>
								</tr>
							</tbody>
						</table>
						<p><font size="5">('$' <i>means you should type this in your terminal application</i>)</font></p>
					</section>

					<section data-state="fabian">
						<h1>Elasticsearch bulk format</h1>
						<span class="fragment"><code><pre>{"index":{"_index":"loc","_type":"work","_id":"c000101650"}}</pre></code></span>
						<span class="fragment"><code><pre>{@context: ...,"id":"http://...","type":["Work","Text"],...}</pre></code></span>
						<span class="fragment"><p>bulk.ndjson</p></span>
					</section>

					<section>
						<h1>Input data format</h1>
						<span class="fragment">
							<pre><code class="json" data-trim>
{
  "@context": { ... },
  "@graph": [
    { "id": "http://.../1", "type": ["Work", "Text"], ... },
    { "id": "http://.../2", "type": ["Work", "Text"], ... },
    ...
  ]
}
							</code></pre>
						</span>
						<span class="fragment"><p>We want to process each element of the @graph array</p></span>
					</section>

					<section data-state="fabian">
						<h2>Exercise 8a: Document line</h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
							<col width="15%" />
							<col width="85%" />
							<tbody>
								<tr>
									<td>All</td>
									<td>
										<pre><code class="bash" data-trim>
$ cat loc-100-compact.json | jq
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>All, 1 line</td>
									<td>
										<pre><code class="bash" data-trim>
$ cat loc-100-compact.json | jq -c .
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Each doc, 1 line</td>
									<td>
										<pre><code class="bash" data-trim>
$ cat loc-100-compact.json | jq -c '.["@graph"][]'
										</code></pre>
										<pre><p><font size="5"><i>@graph requires special escaping in jq with ', [], "</i></font></p></pre>
									</td>
								</tr>
							</tbody>
						</table>
						<p><font size="5">('$' <i>means you should type this in your terminal application</i>)</font></p>
						<span class="fragment"><p>Second line for each pair in bulk.ndjson: 1 doc in 1 line</p></span>
					</section>

					<section data-state="fabian">
						<h2>Exercise 8b: Metadata line</h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
							<col width="20%" />
							<col width="80%" />
							<tbody>
								<tr>
									<td>Like previous</td>
									<td>
										<pre><code class="bash" data-trim>
$ cat loc-100-compact.json | \
jq -c '.["@graph"][] | .'
									</td>
								</tr>
								<tr>
									<td>Construct JSON</td>
									<td>
										<pre><code class="bash" data-trim>
$ cat loc-100-compact.json | \
jq -c '.["@graph"][] | { test:1 }'
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Insert values</td>
									<td>
										<pre><code class="bash" data-trim>
$ cat loc-100-compact.json | \
jq -c '.["@graph"][] | { _id:.id }'
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Full metadata</td>
									<td>
										<pre><code class="bash" data-trim>
$ cat loc-100-compact.json | \
jq -c '.["@graph"][] | { "index":{"_index":"loc", "_type":"work", "_id":.id} }'
										</code></pre>
									</td>
								</tr>
							</tbody>
						</table>
						<span class="fragment"><p>First line for each pair in bulk.ndjson: index metadata</p></span>
					</section>

					<section data-state="fabian">
						<h2>Exercise 8c: Putting it together</h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
							<col width="15%" />
							<col width="85%" />
							<tbody>
								<tr>
									<td>Insert newline with -r</td>
									<td>
										<pre><code class="bash" data-trim>
$ cat loc-100-compact.json | jq -r \
'.["@graph"][] | "\({meta:1})\n\({data:2})"'
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Write bulk .ndjson</td>
									<td>
										<pre><code class="bash" data-trim>
$ cat loc-100-compact.json | jq -r \
'.["@graph"][] | "\({ "index":{"_index":"loc", "_type":"work", "_id":.id} })\n\(.)"' \
> bulk.ndjson
										</code></pre>
									</td>
								</tr>
							</tbody>
						</table>
						<p><font size="5">('$' <i>means you should type this in your terminal application</i>)</font></p>
					</section>

					<section data-state="fabian">
						<h1>Elasticsearch bulk API</h1>
						<span class="fragment"><p>Send the bulk.ndjson file to the Elasticsearch bulk API</p></span>
						<span class="fragment"><p>HTTP POST to /_bulk</p></span>
					</section>

					<section data-state="pascal">
						<p>Setup</p>
						<blockquote><h1>You Know,<br/> for Search</h1></blockquote>
						<p><a href='http://localhost:9200'>http://localhost:9200</a></p>
					</section>

					<section data-state="fabian">
						<h2>Exercise 9: Bulk indexing</h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
							<col width="10%" />
							<col width="90%" />
							<tbody>
								<tr>
									<td>Check data</td>
									<td>
										<pre><code class="bash" data-trim>
$ tail -n 2 bulk.ndjson
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Index data</td>
									<td>
										<pre><code class="bash" data-trim>
$ curl -H "Content-Type: application/x-ndjson" \
-XPOST localhost:9200/_bulk \
--data-binary "@bulk.ndjson" | jq
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Check index</td>
									<td>
										<pre><code class="bash" data-trim>
$ curl localhost:9200/loc/work/_search | jq
										</code></pre>
									</td>
								</tr>
							</tbody>
						</table>
						<p><font size="5">('$' <i>means you should type this in your terminal application</i>)</font></p>
						<span class="fragment"><p><a href='http://localhost:9200/loc/work/_search'>http://localhost:9200/loc/work/_search</a></p></span>
					</section>

					<section data-state="fabian">
						<p>Part IIb.</p>
						<blockquote><h2>Access the Elasticsearch index</h2></blockquote>
						<blockquote><h2>Search queries, direct access by ID</h2></blockquote>
					</section>

					<section data-state="fabian">
						<h1>Elasticsearch URI search</h1>
						<span class="fragment"><p>Search query as part of the URI (very versatile: full text, fields, boolean operators, wildcards, etc.)</p></span>
						<span class="fragment"><p>(Won't cover here: body search, even more advanced)</p></span>
						<span class="fragment"><p>HTTP GET .../&lt;index&gt;/&lt;type&gt;/_search?q=&lt;query-string&gt;</p></span>
						<span class="fragment"><p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-query-string-query.html#query-string-syntax">Elasticsearch documentation</a></p></span>
					</section>

					<section data-state="fabian">
						<h2>Exercise 10a: Query syntax</h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
							<col width="15%" />
							<col width="85%" />
							<tbody>
								<tr>
									<td>Full text</td>
									<td>
										<pre><code class="bash" data-trim>
$ curl localhost:9200/loc/work/_search?q=&lt;???&gt; | jq
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Field search</td>
									<td>
										<pre><code class="bash" data-trim>
# &lt;field&gt;:&lt;term&gt;
$ curl localhost:9200/loc/work/_search?q=&lt;???&gt; | jq
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Boolean</td>
									<td>
										<pre><code class="bash" data-trim>
# AND, OR
$ curl localhost:9200/loc/work/_search?q=&lt;???&gt; | jq
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Wildcards</td>
									<td>
										<pre><code class="bash" data-trim>
# truncate with *
$ curl localhost:9200/loc/work/_search?q=&lt;???&gt; | jq
										</code></pre>
									</td>
								</tr>
							</tbody>
						</table>
						<p><font size="5">('&lt;???&gt;' <i>means you should insert your solution here</i>)</font></p>
					</section>

					<section data-state="fabian">
						<h2>Exercise 10b: Solutions</h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
							<col width="15%" />
							<col width="85%" />
							<tbody>
								<tr>
									<td>Full text</td>
									<td>
										<pre><code class="bash" data-trim>
$ curl localhost:9200/loc/work/_search?q=america | jq
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Field search</td>
									<td>
										<pre><code class="bash" data-trim>
$ curl localhost:9200/loc/work/_search?q=label:letters | jq
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Boolean</td>
									<td>
										<pre><code class="bash" data-trim>
$ curl localhost:9200/loc/work/_search?q=canada+OR+alaska | jq
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Wildcards</td>
									<td>
										<pre><code class="bash" data-trim>
$ curl localhost:9200/loc/work/_search?q=ameri* | jq
										</code></pre>
									</td>
								</tr>
							</tbody>
						</table>
						<p><font size="5">('$' <i>means you should type this in your terminal application</i>)</font></p>
					</section>

					<section data-state="fabian">
						<h1>Direct access by ID</h1>
						<span class="fragment"><p>Direct doc access: /&lt;index&gt;/&lt;type&gt;/&lt;id&gt;</p></span>
						<span class="fragment"><p><i>http://example.com/loc/work/c000000007</i></p></span>
						<span class="fragment"><p>But our index IDs are URIs</p></span>
						<span class="fragment"><p><small><a href='http://localhost:9200/loc/work/http%3A%2F%2Fid.loc.gov%2Fresources%2Fworks%2Fc000000007'>
						http://localhost:9200/loc/work/http%3A%2F%2Fid.loc.gov%2Fresources%2Fworks%2Fc000000007</a></p></span></small>
					</section>

					<section data-state="fabian">
						<h2>Exercise 11a: Re-index</h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
							<col width="15%" />
							<col width="85%" />
							<tbody>
								<tr>
									<td>jq: split</td>
									<td>
										<pre><code class="bash" data-trim>
$ cat loc-compact.json | jq '(.id / "/") | last'
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Recreate bulk .ndjson</td>
									<td>
										<pre><code class="bash" data-trim>
$ cat loc-100-compact.json | jq -r \
'.["@graph"][] | "\({ "index":{"_index":"loc", "_type":"work", "_id":(.id / "/") | last} })\n\(.)"' > bulk.ndjson
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Delete index</td>
									<td>
										<pre><code class="bash" data-trim>
$ curl -XDELETE localhost:9200/loc | jq
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Reindex</td>
									<td>
										<pre><code class="bash" data-trim>
$ curl -H "Content-Type: application/x-ndjson" \
-XPOST localhost:9200/_bulk \
--data-binary "@bulk.ndjson" | jq
										</code></pre>
									</td>
								</tr>
							</tbody>
						</table>
					</section>

					<section data-state="fabian">
						<h2>Exercise 11b: GET by ID</h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
							<col width="20%" />
							<col width="80%" />
							<tbody>
								<tr>
									<td>GET by ID</td>
									<td>
										<pre><code class="bash" data-trim>
$ curl "localhost:9200/&lt;???&gt;/&lt;???&gt;/&lt;???&gt;" \
| jq
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Source only, formatted</td>
									<td>
										<pre><code class="bash" data-trim>
$ curl \
"localhost:9200/&lt;???&gt;/&lt;???&gt;/&lt;???&gt;/_source" \
| jq
										</code></pre>
									</td>
								</tr>
							</tbody>
						</table>
						<p><font size="5">('&lt;???&gt;' <i>means you should insert your solution here</i>)</font></p>
					</section>

					<section data-state="fabian">
						<h2>Exercise 11c: Solutions</h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
							<col width="20%" />
							<col width="80%" />
							<tbody>
								<tr>
									<td>GET by ID</td>
									<td>
										<pre><code class="bash" data-trim>
$ curl "localhost:9200/loc/work/c000000026" \
| jq
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Source only, formatted</td>
									<td>
										<pre><code class="bash" data-trim>
$ curl "localhost:9200/loc/work/c000000026/_source" \
| jq
										</code></pre>
									</td>
								</tr>
							</tbody>
						</table>
						<p><font size="5">('$' <i>means you should type this in your terminal application</i>)</font></p>
					</section>

					<section data-state="fabian">
						<h1>Direct access by ID</h1>
						<span class="fragment"><p>Direct access by ID: /&lt;index&gt;/&lt;type&gt;/&lt;id&gt;</p></span>
						<span class="fragment"><p><a href='http://localhost:9200/loc/work/c000000026'>http://localhost:9200/loc/work/c000000026</a></p></span>
					</section>

					<section data-state="fabian">
						<h2>Exercise 12a: Remote JSON to N-Quads</h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
							<col width="18%" />
							<col width="82%" />
							<tbody>
								<tr>
									<td>Local</td>
									<td>
										<pre><code class="bash" data-trim>
$ jsonld format -q loc-compact.json
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Remote</td>
									<td>
										<pre><code class="bash" data-trim>
$ jsonld format -q http://localhost:9200/loc/work/c000000026/_source
										</code></pre>
									</td>
								</tr>
							</tbody>
						</table>
						<span class="fragment"><p>No context: was included once, at top level, with @graph</p></span>
					</section>

					<section data-state="fabian">
						<h1>Input data format</h1>
						<pre><code class="json" data-trim>
{
  "@context": { ... },
  "@graph": [
    { "id": "http://.../1", "type": ["Work", "Text"], ... },
    { "id": "http://.../2", "type": ["Work", "Text"], ... },
    ...
  ]
}
						</code></pre>
						<p>We processed &amp; indexed each element of the @graph array</p>
					</section>

					<section data-state="fabian">
						<h1>Add context</h1>
						<span class="fragment"><p>Need to include for each document</p></span>
						<span class="fragment"><p>Not embedded, but remote: add context URL</p></span>
						<span class="fragment"><p>(Server needs to serve context as application/ld+json, with CORS header, we will cover CORS in part III)</p></span>
					</section>

					<section data-state="fabian">
						<h2>Exercise 12b: Serve context</h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
							<col width="30%" />
							<col width="70%" />
							<tbody>
								<tr>
									<td>Run server (new terminal)</td>
									<td>
										<pre><code class="bash" data-trim>
$ cd ~/git/swib18-workshop ; npm start
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Access context (old terminal)</td>
									<td>
										<pre><code class="bash" data-trim>
$ curl http://localhost:3000/context.json | jq
										</code></pre>
									</td>
								</tr>
							</tbody>
						</table>
						<p><font size="5">('$' <i>means you should type this in your terminal application</i>)</font></p>
					</section>

					<section data-state="fabian">
						<h2>Exercise 12c: Link to context</h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
							<col width="10%" />
							<col width="90%" />
							<tbody>
								<tr>
									<td>jq: add JSON</td>
									<td>
										<pre><code class="bash" data-trim>
$ cat loc-100-compact.json | \
jq -c '.["@graph"][] | . + {"test": 1}'
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Add context URL</td>
									<td>
										<pre><code class="bash" data-trim>
$ cat loc-100-compact.json | \
jq -c '.["@graph"][] | . + {"@context":"http://localhost:3000/context.json"}'
										</code></pre>
									</td>
								</tr>
																<tr>
									<td>Write bulk .ndjson</td>
									<td>
										<pre><code class="bash" data-trim>
$ cat loc-100-compact.json | jq -r \
'.["@graph"][] | "\({ "index":{"_index":"loc", "_type":"work", "_id":(.id / "/") | last} })\n\({"@context":"http://localhost:3000/context.json"}+.)"' > bulk.ndjson
										</code></pre>
									</td>
								</tr>
							</tbody>
						</table>
					</section>

					<section data-state="fabian">
						<h2>Exercise 12d: Reindex and use</h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
							<col width="15%" />
							<col width="85%" />
							<tbody>
								<tr>
									<td>Delete index</td>
									<td>
										<pre><code class="bash" data-trim>
$ curl -XDELETE localhost:9200/loc | jq
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Reindex</td>
									<td>
										<pre><code class="bash" data-trim>
$ curl -H "Content-Type: application/x-ndjson" \
-XPOST localhost:9200/_bulk \
--data-binary "@bulk.ndjson" | jq
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>To N-Quads</td>
									<td>
										<pre><code class="bash" data-trim>
$ jsonld format -q http://localhost:9200/loc/work/c000000026/_source
										</code></pre>
									</td>
								</tr>
							</tbody>
						</table>
						<p><font size="5">('$' <i>means you should type this in your terminal application</i>)</font></p>
					</section>

					<section data-state="fabian">
						<blockquote>API: How &mdash; JSON over HTTP</blockquote>
						<h2>Serving our data as JSON over HTTP, serializable as RDF</h2>
					</section>

					<section data-state="fabian">
						<h1>Elasticsearch: so much more</h1>
						<p><span class="fragment">Boosting, Analyzers, Aggregations, etc.</span></p>
						<p><span class="fragment"><a href='https://www.elastic.co/guide/en/elasticsearch/guide/current/index.html'>Elasticsearch: The Definitive Guide (concepts)</a></span></p>
						<p><span class="fragment"><a href='https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html'>Elasticsearch Reference (current API)</a></span></p>
					</section>

					<section data-state="fabian">
						<p>Part II: Index and access the data with Elasticsearch</p>
						<span class="fragment">Part III: Use the data to build a web application</span>
					</section>

					<section data-state="fabian">
						<h2>Part III:<br><small>Use the data to build a web application</small></h2>
						<table>
							<tr><th width="25%"/><th width="50%"/><th width="25%"/></tr>
							<tr><td><b>Search page</b></td><td>HTML page for index search</td><td>16:00-16:30</td></tr>
							<tr><td><b>Sample searches</b></td><td>Use the page to query the data</td><td>16:30-17:00</td></tr>
							<tr><td><b>Hypothes.is</b></td><td>Embed Hypothes.is in HTML, add annotations to document the data</td><td>17:00-17:30</td></tr>
						</table>
					</section>

					<section data-state="fabian">
						<p>Part IIIa.</p>
						<blockquote><h2>Search page</h2></blockquote>
						<blockquote><h2>HTML page for index search</h2></blockquote>
					</section>

					<section data-state="fabian">
						<h2>Exercise 13: HTML</h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
							<col width="25%" />
							<col width="75%" />
							<tbody>
								<tr>
									<td>Edit new file</td>
									<td>
										<pre><code class="bash" data-trim>
$ gedit search.html &amp;
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Paste content</td>
									<td>
										<pre><code class="html" data-trim>
&lt;!DOCTYPE html&gt;
&lt;html&gt;
	&lt;head&gt;
		&lt;meta charset=&quot;UTF-8&quot;&gt;
		&lt;title&gt;Title&lt;/title&gt;
	&lt;/head&gt;
	&lt;body&gt;
		Hello HTML
	&lt;/body&gt;
&lt;/html&gt;
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Open in browser</td>
									<td>
										<pre><code class="bash" data-trim>
$ chromium-browser search.html &amp;
										</code></pre>
									</td>
								</tr>
							</tbody>
						</table>
					</section>

					<section data-state="fabian">
						<h1>JQuery</h1>
						<span class="fragment"><p>Provides API to simplify interaction with the browser DOM (document object model)</p></span>
						<span class="fragment"><p>Dynamic content, user interaction, web service calls</p></span>
					</section>

					<section data-state="fabian">
						<h2>Exercise 14: Text Input</h2>
						<pre><code class="html" data-trim>
&lt;head&gt;
  &lt;!-- previous head content --&gt;
  &lt;script src=&quot;https://code.jquery.com/jquery-3.3.1.min.js&quot;&gt;
  &lt;/script&gt;
&lt;/head&gt;
						</code></pre>
						<pre><code class="html" data-trim>
&lt;body&gt;
	&lt;input id='search' type='text'/&gt;
	&lt;script&gt;
		$('#search').keyup(function() {
			var q = $('#search').val();
			console.log(q);
		});
	&lt;/script&gt;
	&lt;div id='result'&gt;&lt;/div&gt;
&lt;/body&gt;
						</code></pre>
						<p><font size="5">(Open your browser's developer tools with Ctrl+Shift+I to see the console.log output)</font></p>
					</section>

					<section data-state="fabian">
						<h1>AJAX</h1>
						<span class="fragment"><p>"Asynchronous JavaScript And XML"</p></span>
						<span class="fragment"><p>Asynchronous JavaScript And <strike>XML</strike> JSON</p></span>
						<span class="fragment"><p>Call web services, do something when we get the result</p></span>
						<span class="fragment"><p>Part of the browser: XMLHttpRequest</p></span>
						<span class="fragment"><p>Also available in JQuery: $.ajax(options)</p></span>
					</section>

					<section data-state="fabian">
						<h2>Exercise 15: AJAX request</h2>
						<pre><code class="javascript" data-trim>
$('#search').keyup(function() { // <-- insert after this
  var q = encodeURIComponent($('#search').val());
  $.ajax({
	url: `http://localhost:9200/loc/work/_search?&q=${q}`,
	success: function(result) {
		console.log(JSON.stringify(result));
	},
	error: function(jqXHR, textStatus, errorThrown) {
		console.log(textStatus, ': ', errorThrown);
	}
  });
});
						</code></pre>
						<p><font size="5">(Open your browser's developer tools with Ctrl+Shift+I to see the console.log output)</font></p>
					</section>

					<section data-state="fabian">
						<h2>Cross-Origin Resource Sharing (CORS)</h2>
						<span class="fragment"><p>Error: not allowed by Access-Control-Allow-Origin</p></span>
						<span class="fragment"><p>Client (our HTML+JS) is in a different location than the web service API we are calling (Elasticsearch server)</p></span>
						<span class="fragment"><p>API server needs to set header: Access-Control-Allow-Origin</p></span>
						<span class="fragment"><p>Specify which domain can make requests, or set it to * to allow access from anywhere</p></span>
					</section>

					<section data-state="fabian">
						<h2>Exercise 16: Configure CORS</h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
							<col width="25%" />
							<col width="75%" />
							<tbody>
								<tr>
									<td>Edit config file</td>
									<td>
										<pre><code class="bash" data-trim>
$ sudo gedit /etc/elasticsearch/elasticsearch.yml
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Add content</td>
									<td>
										<pre><code class="yaml" data-trim>
"http": {
    "cors.enabled": true,
    "cors.allow-origin": "*"
}
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Restart Elasticsearch</td>
									<td>
										<pre><code class="bash" data-trim>
$ sudo service elasticsearch restart
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Check log</td>
									<td>
										<pre><code class="nohighlight" data-trim>
$ sudo tail -f /var/log/elasticsearch/elasticsearch.log
										</code></pre>
									</td>
								</tr>
							</tbody>
						</table>
						<p><small>Stop the tail command with Ctrl+C after the restart is complete ("started")</small></p>
					</section>

					<section data-state="fabian">
						<h2>Exercise 17: <br/>AJAX request, second try</h2>
						<pre><code class="javascript" data-trim>
$('#search').keyup(function() { // <-- insert after this
  var q = encodeURIComponent($('#search').val());
  $.ajax({
	url: `http://localhost:9200/loc/work/_search?&q=${q}`,
	success: function(result) {
		console.log(JSON.stringify(result));
	},
	error: function(jqXHR, textStatus, errorThrown) {
		console.log(textStatus, ': ', errorThrown);
	}
  });
});
						</code></pre>
						<p><font size="5">(Open your browser's developer tools with Ctrl+Shift+I to see the console.log output)</font></p>
					</section>

					<section data-state="fabian">
						<h2>Response format</h2>
						<pre><code class="json" data-trim>
{
  "took": 1,
  "timed_out": false,
  "hits": {
    "total": 100,
    "max_score": 1,
    "hits": [
      {
        "_index": "loc",
        "_type": "work",
        "_id": "c000000007",
        "_score": 1,
        "_source": {
          "@context": "context.json",
          "id": "http://id.loc.gov/resources/works/c000000007",
						</code></pre>
					</section>

					<section data-state="fabian">
						<h2>Exercise 18: Process hits</h2>
						<pre><code class="javascript" data-trim>
success: function(result) {
	console.log(JSON.stringify(result)); // add after this
	$("#result").html('&lt;p/&gt;');
	var hits = result.hits.hits;
	for (let hit of hits) {
		var label = hit._source.label;
		$("#result").append('&lt;hr/&gt;' + label);
	}
}
						</code></pre>
						<p>Append the label of each hit to the result div in our HTML</p>
					</section>

					<section data-state="fabian" data-background="img/search-0-simple.png"
						data-background-size="contain">
					</section>

					<section data-state="fabian">
						<h2>Exercise 19: Improve UI</h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
							<col width="10%" />
							<col width="90%" />
							<tbody>
								<tr>
									<td>Total hits</td>
									<td>
										<strike><pre><code class="javascript" data-trim>
$("#result").html('&lt;p/&gt;');
										</code></pre></strike>
										<pre><code class="javascript" data-trim>
$("#result").html(`<p>Hits: ${result.hits.total}</p>`);
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Links</td>
									<td>
										<strike><pre><code class="javascript" data-trim>
$("#result").append('&lt;hr/&gt;' + label);
										</code></pre></strike>
										<pre><code class="javascript" data-trim>
var link = `<a href='http://localhost:9200/loc/work/`+
`${hit._id}/_source'>${label}</a>`;
$("#result").append('<hr/>' + link);
										</code></pre>
									</td>
								</tr>
							</tbody>
						</table>
						</code></pre>
						<p>Show total hits, link from each hit to its JSON</p>
					</section>

					<section data-state="fabian" data-background="img/search-1-html.png"
						data-background-size="contain">
					</section>

					<section data-state="fabian">
						<p>Part IIIb.</p>
						<blockquote><h2>Sample searches</h2></blockquote>
						<blockquote><h2>Use the page to query the data</h2></blockquote>
					</section>

					<section data-state="fabian">
						<h1>Documentation</h1>
						<p><span class="fragment">Which field? How is it nested?</span></p>
						<p><span class="fragment">Samples very useful as documentation</span></p>
						<p><span class="fragment">Embed a live sample from the index in the search UI</span></p>
						<span class="fragment"><blockquote><a href='https://www.slideshare.net/azaroth42/europeanatech-keynote-shout-it-out-loud/22'>&starf;</a> Documentation with working examples</blockquote></span>
						<p><span class="fragment"><a href='http://blog.lobid.org/2017/04/26/api-documentation-2.html'>(Read more about how we document the lobid API)</a></span></p>
					</section>

					<section data-state="fabian">
						<h2>Exercise 20: columns</h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
							<col width="30%" />
							<col width="70%" />
							<tbody>
								<tr>
									<td>Wrap body content in divs</td>
									<td>
						<pre><code class="html" data-trim>
&lt;div class='row'&gt;
  &lt;div class='col'&gt;
    &lt;code&gt;&lt;pre id='sample'&gt;&lt;/pre&gt;&lt;/code&gt;
  &lt;/div&gt;
  &lt;div class='col'&gt;
    <!-- previous body content -->
  &lt;/div&gt;
&lt;/div&gt;
						</code></pre>
									</td>
								</tr>
								<tr>
									<td>Define CSS styles in head</td>
									<td>
						<pre><code class="html" data-trim>
&lt;head&gt;
  &lt;!-- previous head content --&gt;
  &lt;style&gt;
    .row { display: flex; }
    .col { flex: 50%; margin: 5px; }
    #sample { white-space: pre-wrap; }
  &lt;/style&gt;
&lt;/head&gt;
						</code></pre>
									</td>
								</tr>
							</tbody>
						</table>
						</code></pre>
					</section>

					<section data-state="fabian">
						<h2>Exercise 21:<br/> Embed sample from index</h2>
						<pre><code class="javascript" data-trim>
&lt;script&gt;
 $.ajax({
  url: 'http://localhost:9200/loc/work/c000000026/_source',
  success: function(result) {
    console.log(JSON.stringify(result));
    $("#sample").html(JSON.stringify(result, null, 2));
  },
  error: function(jqXHR, textStatus, errorThrown) {
    console.log(textStatus, ': ', errorThrown);
  }
 });
 // previous script content here
&lt;/script&gt;
						</code></pre>
						<p><font size="5">(Open your browser's developer tools with Ctrl+Shift+I to see the console.log output)</font></p>
					</section>

					<section data-state="fabian" data-background="img/search-2-sample.png"
						data-background-size="contain">
					</section>

					<section data-state="fabian">
						<h2><blockquote><a href='https://www.slideshare.net/azaroth42/europeanatech-keynote-shout-it-out-loud/22'>&starf;</a> Comprehensible by introspection</blockquote></h2>
						<p><span class="fragment">Look at sample document</span></p>
						<p><span class="fragment">Full query access to every field you see</span></p>
						<p><span class="fragment">(Look up details for meaning of keys in the context)</span></p>
					</section>

					<section data-state="fabian">
						<h1>What you see is what you can query</h1>
						<p><span class="fragment">Don't pre-define fixed params for authors, subjects, etc.</span></p>
						<p><span class="fragment">Instead define a general syntax to query any field</span></p>
						<p><span class="fragment">New fields added to the data can immediately be queried</span></p>
						<span class="fragment"><blockquote><p><a href='https://www.slideshare.net/azaroth42/europeanatech-keynote-shout-it-out-loud/32'>4. </a>Define success, not failure</p></blockquote></span>
					</section>

					<section data-state="fabian">
						<h2>Exercise 22: Query syntax</h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
							<col width="25%" />
							<col width="75%" />
							<tbody>
								<tr>
									<td>Field search</td>
									<td>
										<pre><code class="bash" data-trim>
??? # &lt;field&gt;:&lt;term&gt;
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Boolean</td>
									<td>
										<pre><code class="bash" data-trim>
??? # AND, OR
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Wildcards</td>
									<td>
										<pre><code class="bash" data-trim>
??? # truncate with *
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Ranges</td>
									<td>
										<pre><code class="bash" data-trim>
??? # &lt;field&gt;:[* TO &lt;???&gt;], creation date?
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Exists</td>
									<td>
										<pre><code class="bash" data-trim>
??? # _exists_:&lt;field&gt;, geo information?
										</code></pre>
									</td>
								</tr>
							</tbody>
						</table>
						<p><font size="5"><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-query-string-query.html#query-string-syntax">Elasticsearch query string documentation</a></font></p>
					</section>

					<section data-state="fabian">
						<h2>Exercise 22: Solutions</h2>
						<table style="border: 1px solid white; table-layout:fixed; width: 100%">
							<col width="25%" />
							<col width="75%" />
							<tbody>
								<tr>
									<td>Field search</td>
									<td>
										<pre><code class="bash" data-trim>
label:letters
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Boolean</td>
									<td>
										<pre><code class="bash" data-trim>
canada OR alaska
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Wildcards</td>
									<td>
										<pre><code class="bash" data-trim>
ameri*
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Ranges</td>
									<td>
										<pre><code class="bash" data-trim>
adminMetadata.creationDate:[* TO 1995-12-31]
										</code></pre>
									</td>
								</tr>
								<tr>
									<td>Exists</td>
									<td>
										<pre><code class="bash" data-trim>
_exists_:geographicCoverage
										</code></pre>
									</td>
								</tr>
							</tbody>
						</table>
						<p><font size="5"><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-query-string-query.html#query-string-syntax">Elasticsearch query string documentation</a></font></p>
					</section>

					<section data-state="fabian">
						<p>Part IIIc.</p>
						<blockquote><h2>Hypothes.is</h2></blockquote>
						<blockquote><h2>Embed Hypothes.is in HTML, add annotations to document the data</h2></blockquote>
					</section>

					<section data-state="fabian">
						<h1>Hypothes.is</h1>
						<p><span class="fragment">"Annotate the web, with anyone, anywhere"</span></p>
						<p><span class="fragment">"Use Hypothesis right now to hold discussions, read socially, organize your research, and take personal notes"</span></p>
						<p><span class="fragment">or: to create sample-based, collaborative documentation</span></p>
						<p><span class="fragment">Based on browser plugin, proxy server, or embedded JS</span></p>
					</section>

					<section data-state="fabian">
						<h2>Exercise 23:<br/>Embedding Hypothes.is</h2>
						<pre><code class="html" data-trim>
&lt;head&gt;
  &lt;!-- previous head content --&gt;

  &lt;script type="application/json" class="js-hypothesis-config"&gt;
    { "openSidebar": true }
  &lt;/script&gt;

  &lt;script src="https://hypothes.is/embed.js" async&gt;&lt;/script&gt;

  &lt;link rel="canonical" 
    href="https://hbz.github.io/swib18-workshop/search.html"/&gt;
&lt;/head&gt;
						</code></pre>
						<p><small>(Only embed.js script is required, config and canonical link are optional)</small>
					</section>

					<section data-state="fabian" data-background="img/search-3-annotation.png"
						data-background-size="contain">
					</section>

					<section data-state="fabian">
						<h2>Exercise 24:<br/>Add annotations</h2>
						<p>Based on your experience in the query exercise, pick a field and document it like in one of the sample annotations</p>
						<p>Markdown syntax is supported for links etc.</p>
						<p>Use the `swib18-workshop` tag to make it searchable</p>
						<p><a href="https://hypothes.is/search?q=tag:%22swib18-workshop%22">https://hypothes.is/search?q=tag:%22swib18-workshop%22</a></p>
					</section>

					<section data-state="fabian">
						<p>Part III: Use the data to build a web application</p>
						<span class="fragment">Part IV: Use the data with existing tools</span>
					</section>

					<section data-state="adrian">
						<h2>Part IV:<br><small>Use the data with existing tools</small></h2>
						<table>
							<tr><th width="25%"/><th width="50%"/><th width="25%"/></tr>
							<tr><td><b>Kibana</b></td><td>Create visualizations for local index data; look at full data visualizations</td><td>17:30-18:15</td></tr>
							<tr><td><b>OpenRefine</b></td><td>Use index data in OpenRefine; brief intro to the reconciliation API</td><td>18:15-18:45</td></tr>
						</table>
					</section>

					<section data-state="adrian">
						<p>Part IVa.</p>
						<blockquote><h2>Kibana</h2></blockquote>
						<blockquote><h2>Create visualizations for local index data; look at full data visualizations</h2></blockquote>
					</section>

					<section data-state="adrian">
						<h1>Kibana</h1>
						<p><span class="fragment">"Explore, Visualize, Discover Data"</span></p>
						<p><span class="fragment">Open source data visualization plugin for Elasticsearch</span></p>
						<p><span class="fragment">Running locally at <a href='http://localhost:5601/'>http://localhost:5601/</a></span></p>
					</section>

					<section data-state="adrian" data-background="img/kibana-1-index-pattern.png"
						data-background-size="contain">
					</section>

					<section data-state="adrian" data-background="img/kibana-2-new-visualization.png"
						data-background-size="contain">
					</section>

					<section data-state="adrian" data-background="img/kibana-3-select-index.png"
						data-background-size="contain">
					</section>

					<section data-background="img/kibana-4-select-X.png"
						data-background-size="contain">
					</section>

					<section data-state="adrian" data-background="img/kibana-5-select-field.png"
						data-background-size="contain">
					</section>

					<section data-state="adrian">
						<h2>Exercise 25: Bar chart</h2>
						<p>Create a bar chart visualization for the <code>'contribution.agent.type'</code> field</p>
						<p><small>(Kibana will display an additional <code>'keyword'</code> suffix)</small></p>
					</section>

					<section data-state="adrian" data-background="img/kibana-6-vis-bar.png"
						data-background-size="contain">
					</section>

					<section data-state="adrian">
						<h2>Exercise 26: Pie chart</h2>
						<p>Create a pie chart visualization for the <code>'adminMetadata.source.label'</code> field</p>
						<p><small>(Kibana will display an additional <code>'keyword'</code> suffix)</small></p>
					</section>

					<section data-state="adrian" data-background="img/kibana-7-vis-pie.png"
						data-background-size="contain">
					</section>

					<section data-state="adrian">
						<h2>Exercise 27: Tag cloud</h2>
						<p>Create a tag cloud visualization for the <code>'subject.componentList.authoritativeLabel'</code> field</p>
						<p><small>(Kibana will display an additional <code>'keyword'</code> suffix)</small></p>
					</section>

					<section data-state="adrian" data-background="img/kibana-8-vis-tag.png"
						data-background-size="contain">
					</section>

					<section data-state="adrian">
						<h2>Kibana: so much more</h2>
						<p><span class="fragment">Other types of aggregations</span></p>
						<p><span class="fragment">Multiple aggregations in a visualization</span></p>
						<p><span class="fragment">Other visualization types</span></p>
						<p><span class="fragment"><a href='https://www.elastic.co/products/kibana'>https://www.elastic.co/products/kibana</a></span></p>
					</section>

					<section data-state="adrian">
						<h1>Kibana: <br/>full LOC index</h1>
						<p><a href='http://kibana.labs.lobid.org/'>http://kibana.labs.lobid.org/</a></p>
					</section>

					<section data-state="adrian">
						<p>Part IVb.</p>
						<blockquote><h2>OpenRefine</h2></blockquote>
						<blockquote><h2>Use index data in OpenRefine; brief intro to the reconciliation API</h2></blockquote>
					</section>

					<section data-state="adrian">
						<h1>OpenRefine</h1>
						<p><span class="fragment">"A powerful tool for working with messy data"</span></p>
						<p><span class="fragment">"cleaning it; transforming it from one format into another; and extending it with web services and external data"</span></p>
						<p><span class="fragment">Spreadsheet-like user interface, in the browser, locally</span></p>
						<p><span class="fragment">Run with <code>./refine</code> in your OpenRefine location, then open <a href='http://localhost:3333/'>http://localhost:3333/</a></span></p>
					</section>

					<section data-state="adrian">
						<h2>Exercise 28: <br/>Getting labels for IDs</h2>
						<pre><code class="nohighlight" data-trim>
http://id.loc.gov/resources/works/c000000011
http://id.loc.gov/resources/works/c000000020
http://id.loc.gov/resources/works/c000000026
http://id.loc.gov/resources/works/c000000028
http://id.loc.gov/resources/works/c000000100
						</code></pre>
						<p>Copy the lines above to the clipboard
					</section>

					<section data-state="adrian" data-background="img/openrefine-1-import.png"
						data-background-size="contain">
					</section>

					<section data-state="adrian" data-background="img/openrefine-2-import.png"
						data-background-size="contain">
					</section>

					<section data-state="adrian" data-background="img/openrefine-3-add-from-url.png"
						data-background-size="contain">
					</section>

					<section data-state="adrian">
						<h2>Create URL to get JSON</h2>
						<span class="fragment">
http://id.loc.gov/resources/works/c000000011
						</span>
						<span class="fragment">
&rarr; http://localhost:9200/loc/work/c000000011/_source
						</span>
						<span class="fragment"><code class="nohighlight" data-trim>
<hr/>
"http://localhost:9200/loc/work/" + split(value, '/')[-1] + "/_source"
						</code>
						<p><small>(Copy this to the clipboard)</small></p></span>
					</section>

					<section data-state="adrian" data-background="img/openrefine-4-add-from-url.png"
						data-background-size="contain">
					</section>

					<section data-state="adrian" data-background="img/openrefine-5-add-from-json.png"
						data-background-size="contain">
					</section>

					<section data-state="adrian" data-background="img/openrefine-6-add-from-json.png"
						data-background-size="contain">
					</section>

					<section data-state="adrian">
						<h2>Exercise 29: <br/>Add first contributing agent</h2>
						<p><span class="fragment"><code>contribution[0].agent.label</code></span></p>
					</section>

					<section data-state="adrian" data-background="img/openrefine-7-export.png"
						data-background-size="contain">
					</section>

					<section data-state="adrian">
						<h2>Exercise 30: <br/>Getting IDs for labels</h2>
						<pre><code class="nohighlight" data-trim>
Letters from an American farmer
Italian journeys
Report of the trial of George Ryan
The devil upon crutches in England
Educational interests of Colorado
						</code></pre>
						<span class="fragment"><p><code>"http://localhost:9200/loc/work/_search?q=\"" + replace(value, " ", "+") + "\""</code></p></span>
						<span class="fragment"><p><code>value.parseJson().hits.hits[0]._source.id</code></p></span>
					</section>

					<section data-state="adrian" data-background="img/openrefine-8-uris.png"
						data-background-size="contain">
					</section>

					<section data-state="adrian">
						<h1>Reconciliation API</h1>
						<p><span class="fragment">All of the above: nothing specific built for OpenRefine, just JSON over HTTP, and lots to explore in OpenRefine</span></p>
						<p><span class="fragment">Implement OpenRefine Reconciliation API (serve some specific JSON) for better integration in OpenRefine UI</span></p>
						<p><span class="fragment">Select best matches using scores and small inline previews, filter by type, suggest fields for data extension, etc.</span></p>
					</section>

					<section data-state="adrian" data-background="img/openrefine-reconcile-1-preview.png"
						data-background-size="contain">
					</section>

					<section data-state="adrian" data-background="img/openrefine-reconcile-2-suggest.png"
						data-background-size="contain">
					</section>

					<section data-state="adrian">
						<h1>Reconciliation details</h1>
						<p><a href="http://blog.lobid.org/2018/08/27/openrefine.html">http://blog.lobid.org/2018/08/27/openrefine.html</a></p>
						<p><a href="https://github.com/OpenRefine/OpenRefine/wiki/Reconciliation">https://github.com/OpenRefine/OpenRefine/wiki/Reconciliation</a></p>
						<p><a href="http://openrefine.org/documentation.html">http://openrefine.org/documentation.html</a></p>
					</section>

					<section data-state="adrian">
						<h2>Review</h2>
						<table>
							<tr><th width="17%"/><th width="83%"/></tr>
							<tr><td><b>Part I</b></td><td>Convert RDF data into usable JSON-LD</td></tr>
							<tr><td><b>Part II</b></td><td>Index &amp; query the data with Elasticsearch</td></tr>
							<tr><td><b>Part III</b></td><td>Use the data to build a web application</td></tr>
							<tr><td><b>Part IV</b></td><td>Use it in existing tools: Kibana, OpenRefine</td></tr>
						</table>
					</section>

					<section data-state="adrian">
						<h1>Time for questions, discussions, feedback</h1>
					</section>

					<section data-state="adrian">
						<h2>Question from #eubfws2018</h2>
						<a href="http://www.casalini.it/EBW2018/web_content/2018/presentations/Hubay.pdf"><img src="img/hubay-2018-bf-8.png" width=800 /></a>
						<small><font size="3">Source: <br/><a href="http://www.casalini.it/EBW2018/web_content/2018/presentations/Hubay.pdf">Miklós Hubay, "The Past, the Present &amp; the
					Future of the Semantic Web &amp; BIBFRAME in National Széchényi Library, Hungary"</a></font></small>
					</section>

					<section data-state="adrian">
						<h1>LOUD is more than a nice JSON-LD API</h1>
						<p><span class="fragment">(But a nice JSON-LD API is LOUDer than an RDF file)</span></p>
					</section>

					<section data-state="adrian">
						<h2>Let's recall</h2>
						<a href="https://www.slideshare.net/azaroth42/europeanatech-keynote-shout-it-out-loud/32"><img src="img/sanderson-2018-loud-32.png" width=800 /></a>
						<p><font size="3">Source: <a href="https://www.slideshare.net/azaroth42/europeanatech-keynote-shout-it-out-loud">Rob Sanderson, "Shout it Out: LOUD"</a>, CC-BY</font></p>
					</section>

					<section data-state="adrian">
						<h2>Bibframe, from LOD to LOUD?</h2>
						<a href="https://www.slideshare.net/azaroth42/europeanatech-keynote-shout-it-out-loud/32"><img src="img/sanderson-2018-loud-32-checked.png" width=800 /></a>
						<p><font size="3">Source: <a href="https://www.slideshare.net/azaroth42/europeanatech-keynote-shout-it-out-loud">Rob Sanderson, "Shout it Out: LOUD"</a>, CC-BY</font></p>
					</section>

					<section data-state="adrian">
						<blockquote><h1><a href='https://www.slideshare.net/azaroth42/europeanatech-keynote-shout-it-out-loud/32'>1. </a>Require use cases, with data</h1></blockquote>
					</section>

					<section data-state="adrian">
						<h1>Code for exercises and HTML for slides available on the web</h1>
						<p><a href="https://github.com/hbz/swib18-workshop/">https://github.com/hbz/swib18-workshop/</a></p>
						<p><a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="img/cc-by.png" title="Licensed under a Creative Commons Attribution 4.0 International License"></a></p>
					</section>
			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			Reveal.addEventListener('fabian', function() { document.querySelector('#footer-left').innerHTML = 'F'; } );
			Reveal.addEventListener('adrian', function() { document.querySelector('#footer-left').innerHTML = 'A'; } );
			Reveal.addEventListener('pascal', function() { document.querySelector('#footer-left').innerHTML = 'P'; } );
			// Full list of configuration options available at:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				transition: 'none', // none/fade/slide/convex/concave/zoom
				backgroundTransition: 'none',
				slideNumber: 'c', // 'c/t'
				hashOneBasedIndex: true,

				// Optional reveal.js plugins
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});

		</script>
	</body>
</html>
